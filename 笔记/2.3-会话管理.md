[TOC]

### 会话管理

- HTTP 的基本性质

  - 简单

  - 可扩展

  - 无状态的，有会话的

    - 无状态：在同一个连接中，两个执行成功的请求之间是没有关系的。=> 用户没有办法在同一个网站中进行连续的交互。
    - 有会话：使用 HTTP 的头部扩展，HTTP Cookies 可以解决这个问题。把 Cookies 添加到头部中，创建一个会话让每次请求都能共享相同的上下文信息，达成相同的状态。
    - HTTP 本质是无状态的，使用 Cookies 可以创建有状态的会话。

    > 以上内容摘自MDN

- Cookie

  - 是服务器发送到浏览器，并保存在**浏览器端**的一小块数据
  - 浏览器下次访问该服务器的时候，会自动携带该数据，并将其发送给服务器

- Session

  - 是 **JavaEE** 的标准，用于在服务端记录客户端信息
  - 数据存放在**服务端**更加安全，但也会增加服务端的内存压力



能用 cookie 就用 cookie，存必要数据。

如果只部署一台服务器，则可以用 session ，但如果部署多态服务器，那 session 就会有问题。

- 黏性 session 不完美。因为这样 nginx 无法做到负载均衡。
- 如果服务器都有相同的 session （同步 session ），那么造成了冗余，服务器压力增大。
- 共享 session  ，单拿一个服务器用于存储 session ，但是万一这个服务器挂了那就完蛋了。

主流做法是能存 cookie 就存 cookie ，实在不行就存数据库里。然后搞数据库集群。除此之外，传统的关系型数据库的数据是存在硬盘里的（速度慢），因此可以使用 NoSQL 数据库（Redis）。











